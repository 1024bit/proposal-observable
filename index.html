<!doctype html>
<head><meta charset="utf-8">
<title>Observable</title><script type="application/json" id="menu-search-biblio">{"clauses":{"observable-constructor":{"location":"","id":"observable-constructor","aoid":null,"title":"The Observable Constructor","number":"1"},"observable":{"location":"","id":"observable","aoid":null,"title":"Observable ( subscriber )","number":"1.1"},"observable-properties":{"location":"","id":"observable-properties","aoid":null,"title":"Properties of the Observable Constructor","number":"2"},"observable-@@species":{"location":"","id":"observable-@@species","aoid":null,"title":"get Observable [ @@species ]","number":"2.1"},"observable-prototype":{"location":"","id":"observable-prototype","aoid":null,"title":"Observable.prototype","number":"2.2"},"observable-from":{"location":"","id":"observable-from","aoid":null,"title":"Observable.from ( x )","number":"2.3"},"observable-from-wrapping-functions":{"location":"","id":"observable-from-wrapping-functions","aoid":null,"title":"Observable.from Wrapping Functions","number":"2.3.1"},"observable-from-iteration-functions":{"location":"","id":"observable-from-iteration-functions","aoid":null,"title":"Observable.from Iteration Functions","number":"2.3.2"},"observable-from-job":{"location":"","id":"observable-from-job","aoid":null,"title":"ObservableFromJob ( observer, items )","number":"2.3.3"},"observable-of":{"location":"","id":"observable-of","aoid":null,"title":"Observable.of ( ...items )","number":"2.4"},"observable-of-subscriber-functions":{"location":"","id":"observable-of-subscriber-functions","aoid":null,"title":"Observable.of Subscriber Functions","number":"2.4.1"},"observable-of-job":{"location":"","id":"observable-of-job","aoid":null,"title":"ObservableOfJob ( observer, items )","number":"2.4.2"},"observable-prototype-properties":{"location":"","id":"observable-prototype-properties","aoid":null,"title":"Properties of the Observable Prototype Object","number":"3"},"observable-prototype-subscribe":{"location":"","id":"observable-prototype-subscribe","aoid":null,"title":"Observable.prototype.subscribe ( observer )","number":"3.1"},"observable-execute-subscriber":{"location":"","id":"observable-execute-subscriber","aoid":null,"title":"Runtime Semantics: ExecuteSubscriber ( subscriber, observer )","number":"3.1.1"},"observable-subscription-cleanup-functions":{"location":"","id":"observable-subscription-cleanup-functions","aoid":null,"title":"Subscription Cleanup Functions","number":"3.1.2"},"observable-prototype-foreach":{"location":"","id":"observable-prototype-foreach","aoid":null,"title":"Observable.prototype.forEach ( callbackFn )","number":"3.1.3"},"observable-prototype-foreach-next-functions":{"location":"","id":"observable-prototype-foreach-next-functions","aoid":null,"title":"Observable.prototype.forEach Next Functions","number":"3.1.3.1"},"observable-prototype-constructor":{"location":"","id":"observable-prototype-constructor","aoid":null,"title":"Observable.prototype.constructor","number":"3.1.4"},"observable-prototype-@@observable":{"location":"","id":"observable-prototype-@@observable","aoid":null,"title":"Observable.prototype [ @@observable ] ( )","number":"3.1.5"},"subscription-objects":{"location":"","id":"subscription-objects","aoid":null,"title":"Subscription Objects","number":"4"},"subscription-abstract-operations":{"location":"","id":"subscription-abstract-operations","aoid":null,"title":"Subscription Abstract Operations","number":"4.1"},"create-subscription":{"location":"","id":"create-subscription","aoid":null,"title":"CreateSubscription ( observer ) Abstract Operation","number":"4.1.2"},"cleanup-subscription":{"location":"","id":"cleanup-subscription","aoid":null,"title":"CleanupSubscription ( subscription ) Abstract Operation","number":"4.1.3"},"subscription-closed":{"location":"","id":"subscription-closed","aoid":null,"title":"SubscriptionClosed ( subscription ) Abstract Operation","number":"4.1.4"},"subscription-prototype-object":{"location":"","id":"subscription-prototype-object","aoid":null,"title":"The %SubscriptionPrototype% Object","number":"4.1.5"},"subscription-prototype-unsubscribe":{"location":"","id":"subscription-prototype-unsubscribe","aoid":null,"title":"%SubscriptionPrototype%.unsubscribe ( )","number":"4.1.5.1"},"subscription-observer-objects":{"location":"","id":"subscription-observer-objects","aoid":null,"title":"Subscription Observer Objects","number":"5"},"subscription-observer-abstract-operations":{"location":"","id":"subscription-observer-abstract-operations","aoid":null,"title":"Subscription Observer Abstract Operations","number":"5.1"},"create-subscription-observer":{"location":"","id":"create-subscription-observer","aoid":null,"title":"CreateSubscriptionObserver ( subscription ) Abstract Operation","number":"5.1.1"},"subscription-observer-prototype-object":{"location":"","id":"subscription-observer-prototype-object","aoid":null,"title":"The %SubscriptionObserverPrototype% Object","number":"5.2"},"subscription-prototype-closed":{"location":"","id":"subscription-prototype-closed","aoid":null,"title":"get %SubscriptionObserverPrototype%.closed","number":"5.2.1"},"subscription-observer-prototype-next":{"location":"","id":"subscription-observer-prototype-next","aoid":null,"title":"%SubscriptionObserverPrototype%.next ( value )","number":"5.2.2"},"subscription-observer-prototype-error":{"location":"","id":"subscription-observer-prototype-error","aoid":null,"title":"%SubscriptionObserverPrototype%.error ( exception )","number":"5.2.3"},"subscription-observer-prototype-complete":{"location":"","id":"subscription-observer-prototype-complete","aoid":null,"title":"%SubscriptionObserverPrototype%.complete ( value )","number":"5.2.4"}},"ops":{},"productions":{},"terms":{},"examples":{},"notes":{},"tables":{},"figures":{}}</script></head><body><div id="menu-toggle">☰</div><div id="menu"><div id="menu-search"><input type="text" id="menu-search-box" placeholder="Search..."><div id="menu-search-results" class="inactive"></div></div><div id="menu-toc"><ol class="toc"><li><span class="item-toggle">◢</span><a href="#observable-constructor" title="The Observable Constructor"><span class="secnum">1</span> The Observable Constructor</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#observable" title="Observable ( subscriber )"><span class="secnum">1.1</span> Observable ( subscriber )</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#observable-properties" title="Properties of the Observable Constructor"><span class="secnum">2</span> Properties of the Observable Constructor</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#observable-@@species" title="get Observable [ @@species ]"><span class="secnum">2.1</span> get Observable [ @@species ]</a></li><li><span class="item-toggle-none"></span><a href="#observable-prototype" title="Observable.prototype"><span class="secnum">2.2</span> Observable.prototype</a></li><li><span class="item-toggle">◢</span><a href="#observable-from" title="Observable.from ( x )"><span class="secnum">2.3</span> Observable.from ( x )</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#observable-from-wrapping-functions" title="Observable.from Wrapping Functions"><span class="secnum">2.3.1</span> Observable.from Wrapping Functions</a></li><li><span class="item-toggle-none"></span><a href="#observable-from-iteration-functions" title="Observable.from Iteration Functions"><span class="secnum">2.3.2</span> Observable.from Iteration Functions</a></li><li><span class="item-toggle-none"></span><a href="#observable-from-job" title="ObservableFromJob ( observer, items )"><span class="secnum">2.3.3</span> ObservableFromJob ( observer, items )</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#observable-of" title="Observable.of ( ...items )"><span class="secnum">2.4</span> Observable.of ( ...items )</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#observable-of-subscriber-functions" title="Observable.of Subscriber Functions"><span class="secnum">2.4.1</span> Observable.of Subscriber Functions</a></li><li><span class="item-toggle-none"></span><a href="#observable-of-job" title="ObservableOfJob ( observer, items )"><span class="secnum">2.4.2</span> ObservableOfJob ( observer, items )</a></li></ol></li></ol></li><li><span class="item-toggle">◢</span><a href="#observable-prototype-properties" title="Properties of the Observable Prototype Object"><span class="secnum">3</span> Properties of the Observable Prototype Object</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#observable-prototype-subscribe" title="Observable.prototype.subscribe ( observer )"><span class="secnum">3.1</span> Observable.prototype.subscribe ( observer )</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#observable-execute-subscriber" title="Runtime Semantics: ExecuteSubscriber ( subscriber, observer )"><span class="secnum">3.1.1</span> RS: ExecuteSubscriber ( subscriber, observer )</a></li><li><span class="item-toggle-none"></span><a href="#observable-subscription-cleanup-functions" title="Subscription Cleanup Functions"><span class="secnum">3.1.2</span> Subscription Cleanup Functions</a></li><li><span class="item-toggle">◢</span><a href="#observable-prototype-foreach" title="Observable.prototype.forEach ( callbackFn )"><span class="secnum">3.1.3</span> Observable.prototype.forEach ( callbackFn )</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#observable-prototype-foreach-next-functions" title="Observable.prototype.forEach Next Functions"><span class="secnum">3.1.3.1</span> Observable.prototype.forEach Next Functions</a></li></ol></li><li><span class="item-toggle-none"></span><a href="#observable-prototype-constructor" title="Observable.prototype.constructor"><span class="secnum">3.1.4</span> Observable.prototype.constructor</a></li><li><span class="item-toggle-none"></span><a href="#observable-prototype-@@observable" title="Observable.prototype [ @@observable ] ( )"><span class="secnum">3.1.5</span> Observable.prototype [ @@observable ] ( )</a></li></ol></li></ol></li><li><span class="item-toggle">◢</span><a href="#subscription-objects" title="Subscription Objects"><span class="secnum">4</span> Subscription Objects</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#subscription-abstract-operations" title="Subscription Abstract Operations"><span class="secnum">4.1</span> Subscription Abstract Operations</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#create-subscription" title="CreateSubscription ( observer ) Abstract Operation"><span class="secnum">4.1.1</span> CreateSubscription ( observer ) Abstract Operation</a></li><li><span class="item-toggle-none"></span><a href="#create-subscription" title="CreateSubscription ( observer ) Abstract Operation"><span class="secnum">4.1.2</span> CreateSubscription ( observer ) Abstract Operation</a></li><li><span class="item-toggle-none"></span><a href="#cleanup-subscription" title="CleanupSubscription ( subscription ) Abstract Operation"><span class="secnum">4.1.3</span> CleanupSubscription ( subscription ) Abstract Operation</a></li><li><span class="item-toggle-none"></span><a href="#subscription-closed" title="SubscriptionClosed ( subscription ) Abstract Operation"><span class="secnum">4.1.4</span> SubscriptionClosed ( subscription ) Abstract Operation</a></li><li><span class="item-toggle">◢</span><a href="#subscription-prototype-object" title="The %SubscriptionPrototype% Object"><span class="secnum">4.1.5</span> The %SubscriptionPrototype% Object</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#subscription-prototype-unsubscribe" title="%SubscriptionPrototype%.unsubscribe ( )"><span class="secnum">4.1.5.1</span> %SubscriptionPrototype%.unsubscribe ( )</a></li></ol></li></ol></li></ol></li><li><span class="item-toggle">◢</span><a href="#subscription-observer-objects" title="Subscription Observer Objects"><span class="secnum">5</span> Subscription Observer Objects</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#subscription-observer-abstract-operations" title="Subscription Observer Abstract Operations"><span class="secnum">5.1</span> Subscription Observer Abstract Operations</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#create-subscription-observer" title="CreateSubscriptionObserver ( subscription ) Abstract Operation"><span class="secnum">5.1.1</span> CreateSubscriptionObserver ( subscription ) Abstract Operation</a></li></ol></li><li><span class="item-toggle">◢</span><a href="#subscription-observer-prototype-object" title="The %SubscriptionObserverPrototype% Object"><span class="secnum">5.2</span> The %SubscriptionObserverPrototype% Object</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#subscription-prototype-closed" title="get %SubscriptionObserverPrototype%.closed"><span class="secnum">5.2.1</span> get %SubscriptionObserverPrototype%.closed</a></li><li><span class="item-toggle-none"></span><a href="#subscription-observer-prototype-next" title="%SubscriptionObserverPrototype%.next ( value )"><span class="secnum">5.2.2</span> %SubscriptionObserverPrototype%.next ( value )</a></li><li><span class="item-toggle-none"></span><a href="#subscription-observer-prototype-error" title="%SubscriptionObserverPrototype%.error ( exception )"><span class="secnum">5.2.3</span> %SubscriptionObserverPrototype%.error ( exception )</a></li><li><span class="item-toggle-none"></span><a href="#subscription-observer-prototype-complete" title="%SubscriptionObserverPrototype%.complete ( value )"><span class="secnum">5.2.4</span> %SubscriptionObserverPrototype%.complete ( value )</a></li></ol></li></ol></li></ol></div></div><h1 class="version">Stage 1 Draft / November 18, 2015</h1><h1 class="title">Observable</h1>
<script src="https://bterlson.github.io/ecmarkup/ecmarkup.js" defer=""></script>
<link rel="stylesheet" href="https://bterlson.github.io/ecmarkup/elements.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_light.min.css">

<emu-clause id="observable-constructor">
    <h1><span class="secnum">1</span>The Observable Constructor<span class="utils"><span class="anchor"><a href="#observable-constructor">#</a></span></span></h1>

    <p>The Observable constructor is the %Observable% intrinsic object and the initial value of the Observable property of the global object. When called as a constructor it creates and initializes a new Observable object. Observable is not intended to be called as a function and will throw an exception when called in that manner.</p>

    <p>The Observable constructor is designed to be subclassable. It may be used as the value in an extends clause of a class definition. Subclass constructors that intend to inherit the specified Observable behaviour must include a super call to the Observable constructor to create and initialize the subclass instance with the internal state necessary to support the Observable and Observable.prototype built-in methods.</p>

    <emu-clause id="observable">
        <h1><span class="secnum">1.1</span>Observable ( subscriber )<span class="utils"><span class="anchor"><a href="#observable">#</a></span></span></h1>

        <p>The <code>Observable</code> constructor initializes a new Observable object.  It is not intended to be called as a function and will throw an exception when called in that manner.</p>

        <p>The <var>subscriber</var> argument must be a function object.  It is called each time the <code>subscribe</code> method of the Observable object is invoked.  The <var>subscriber</var> function is called with a wrapped observer object and may optionally return a function which will cancel the subscription.</p>

        <p>The <code>Observable</code> constructor performs the following steps:</p>

        <emu-alg><ol><li>If <code>NewTarget</code> is undefined, throw a <code>TypeError</code> exception.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iscallable">IsCallable</a>(<var>subscriber</var>) is <code>false</code>, throw a <code>TypeError</code> exception.</li><li>Let <var>observable</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ordinarycreatefromconstructor">OrdinaryCreateFromConstructor</a>(<code>NewTarget</code>,
               %ObservablePrototype%, «‍[[Subscriber]]»).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<code>observable</code>).</li><li>Set <var>observable's</var> [[Subscriber]] internal slot to <var>subscriber</var>.</li><li>Return <var>observable</var>.
        </li></ol></emu-alg>
    </emu-clause>

</emu-clause>

<emu-clause id="observable-properties">
    <h1><span class="secnum">2</span>Properties of the Observable Constructor<span class="utils"><span class="anchor"><a href="#observable-properties">#</a></span></span></h1>

    <p>The value of the [[Prototype]] internal slot of the <code>Observable</code> constructor is the intrinsic object %FunctionPrototype%.</p>

    <p>Besides the <code>length</code> property (whose value is 1), the <code>Observable</code> constructor has the following properties:</p>

    <emu-import href="./constructor-properties.html"><emu-clause id="observable-@@species">
    <h1><span class="secnum">2.1</span>get Observable [ @@species ]<span class="utils"><span class="anchor"><a href="#observable-@@species">#</a></span></span></h1>

    <p><code>Observable[@@species]</code> is an accessor property whose set accessor function is <code>undefined</code>. Its get accessor function performs the following steps:</p>

    <emu-alg><ol><li>Return the <code>this</code> value.
    </li></ol></emu-alg>
</emu-clause>


<emu-clause id="observable-prototype">
    <h1><span class="secnum">2.2</span>Observable.prototype<span class="utils"><span class="anchor"><a href="#observable-prototype">#</a></span></span></h1>

    <p>The initial value of <code>Observable.prototype</code> is the intrinsic object %ObservablePrototype%.</p>

    <p>This property has the attributes { [[Writable]]: <code>false</code>, [[Enumerable]]: <code>false</code>, [[Configurable]]: <code>false</code> }.</p>
</emu-clause>

<emu-clause id="observable-from">
    <h1><span class="secnum">2.3</span>Observable.from ( x )<span class="utils"><span class="anchor"><a href="#observable-from">#</a></span></span></h1>

    <p>When the <code>from</code> method is called, the following steps are taken:</p>

    <emu-alg><ol><li>Let <var>C</var> be the <code>this</code> value.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-isconstructor">IsConstructor</a>(C) is <code>false</code>, let <var>C</var> be %Observable%.</li><li>Let <var>observableMethod</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getmethod">GetMethod</a>(<var>x</var>, <code>@@observable</code>).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>observableMethod</var>).</li><li>If <var>observableMethod</var> is not <code>undefined</code>,<ol><li>Let <var>observable</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a>(<var>observableMethod</var>, <var>x</var>, «‍»).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>observable</var>).</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>observable</var>) is not Object, throw a <code>TypeError</code> exception.</li><li>Let <var>constructor</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-get-o-p">Get</a>(<var>observable</var>, <code>"constructor"</code>).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>constructor</var>).</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-samevalue">SameValue</a>(<var>constructor</var>, <var>C</var>) is <code>true</code>, return <var>observable</var>.</li><li>Let <var>subscriber</var> be a new built-in function object as defined in Observable.from Wrapping Functions.</li><li>Set the [[Observable]] internal slot of <var>subscriber</var> to <var>observable</var>.</li></ol></li><li>Else,<ol><li>Let <var>subscriber</var> be a new built-in function object as defined in Observable.from Iteration Functions.</li><li>Set the [[Items]] internal slot of <var>subscriber</var> to <var>x</var>.</li></ol></li><li>Return <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-construct">Construct</a>(<var>C</var>, «‍<var>subscriber</var>»).
    </li></ol></emu-alg>

    <emu-clause id="observable-from-wrapping-functions">
        <h1><span class="secnum">2.3.1</span>Observable.from Wrapping Functions<span class="utils"><span class="anchor"><a href="#observable-from-wrapping-functions">#</a></span></span></h1>

        <p>An Observable.from wrapping function is an anonymous bulit-in function that has an [[Observable]] internal slot.</p>

        <p>When an Observable.from wrapping function is called with argument <var>observer</var>, the following steps are taken:</p>

        <emu-alg><ol><li>Let <var>observable</var> be the value of the [[Observable]] internal slot of <var>F</var>.</li><li>Return <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-invoke">Invoke</a>(<var>observable</var>, <code>"subscribe"</code>, «‍<var>observer</var>»).
        </li></ol></emu-alg>

        <p>The <code>length</code> property of an Observable.from wrapping function is <code>1</code>.</p>
    </emu-clause>

    <emu-clause id="observable-from-iteration-functions">
        <h1><span class="secnum">2.3.2</span>Observable.from Iteration Functions<span class="utils"><span class="anchor"><a href="#observable-from-iteration-functions">#</a></span></span></h1>

        <p>An Observable.from iteration function is an anonymous built-in function that has an [[Items]] internal slot.</p>

        <p>When an Observable.from iteration function is called with argument <var>observer</var>, the following steps are taken:</p>

        <emu-alg><ol><li>Let <var>items</var> be the value of the [[Items]] internal slot of <var>F</var>.</li><li>Perform <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-enqueuejob">EnqueueJob</a>(<code>"PromiseJobs"</code>, ObservableFromJob, «‍<var>observer</var>, <var>items</var>»).
        </li></ol></emu-alg>

        <p>The <code>length</code> property of an Observable.from iteration function is <code>1</code>.</p>
    </emu-clause>

    <emu-clause id="observable-from-job">
        <h1><span class="secnum">2.3.3</span>ObservableFromJob ( observer, items )<span class="utils"><span class="anchor"><a href="#observable-from-job">#</a></span></span></h1>
        <emu-alg><ol><li>Let <var>closed</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-toboolean">ToBoolean</a>(<a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-get-o-p">Get</a>(<var>observer</var>, <code>"closed"</code>)).</li><li>IfAbruptNotifyError(<var>closed</var>, <var>observer</var>).</li><li>If <var>closed</var> is <code>true</code>, return <code>undefined</code>.</li><li>Let <var>iterator</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getiterator">GetIterator</a>(<var>observer</var>).</li><li>IfAbruptNotifyError(<var>iterator</var>, <var>observer</var>).</li><li>Repeat<ol><li>Let <var>next</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorstep">IteratorStep</a>(<var>iterator</var>).</li><li>IfAbruptNotifyError(<var>next</var>, <var>observer</var>).</li><li>If <var>next</var> is <code>false</code>,<ol><li>Let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-invoke">Invoke</a>(<var>observer</var>, <code>"complete"</code>, «‍»).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>result</var>).</li><li>Return <code>undefined</code>.</li></ol></li><li>Let <var>nextValue</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iteratorvalue">IteratorValue</a>(<var>next</var>).</li><li>IfAbruptNotifyError(<var>nextValue</var>, <var>observer</var>).</li><li>Let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-invoke">Invoke</a>(<var>observer</var>, <code>"next"</code>, «‍<var>nextValue</var>»).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>result</var>).</li><li>Let <var>closed</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-toboolean">ToBoolean</a>(<a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-get-o-p">Get</a>(<var>observer</var>, <code>"closed"</code>)).</li><li>IfAbruptNotifyError(<var>closed</var>, <var>observer</var>).</li><li>If <var>closed</var> is <code>true</code>, return <code>undefined</code>.
        </li></ol></li></ol></emu-alg>
    </emu-clause>

</emu-clause>

<emu-clause id="observable-of">
    <h1><span class="secnum">2.4</span>Observable.of ( ...items )<span class="utils"><span class="anchor"><a href="#observable-of">#</a></span></span></h1>

    <emu-alg><ol><li>Let <var>C</var> be the <code>this</code> value.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-isconstructor">IsConstructor</a>(C) is <code>false</code>, let <var>C</var> be %Observable%.</li><li>Let <var>subscriber</var> be a new built-in function object as defined in Observable.of Subscriber Functions.</li><li>Set the [[Items]] internal slot of <var>subscriber</var> to <var>items</var>.</li><li>Return <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-construct">Construct</a>(<var>C</var>, «‍<var>subscriber</var>»).
    </li></ol></emu-alg>

    <emu-clause id="observable-of-subscriber-functions">
        <h1><span class="secnum">2.4.1</span>Observable.of Subscriber Functions<span class="utils"><span class="anchor"><a href="#observable-of-subscriber-functions">#</a></span></span></h1>

        <p>An Observable.of subscriber function is an anonymous built-in function that has a [[Items]] internal slot.</p>

        <p>When an Observable.of subscriber function is called with argument <var>observer</var>, the following steps are taken:</p>

        <emu-alg><ol><li>Let <var>items</var> be the value of the [[Items]] internal slot of <var>F</var>.</li><li>Perform <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-enqueuejob">EnqueueJob</a>(<code>"PromiseJobs"</code>, ObservableOfJob, «‍<var>observer</var>, <var>items</var>»).
        </li></ol></emu-alg>

        <p>The <code>length</code> property of an Observable.of subscriber function is <code>1</code>.</p>
    </emu-clause>

    <emu-clause id="observable-of-job">
        <h1><span class="secnum">2.4.2</span>ObservableOfJob ( observer, items )<span class="utils"><span class="anchor"><a href="#observable-of-job">#</a></span></span></h1>

        <p>The job ObservableOfJob with parameters <var>observer</var> and <var>items</var> performs the following steps:</p>

        <emu-alg><ol><li>Let <var>closed</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-toboolean">ToBoolean</a>(<a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-get-o-p">Get</a>(<var>observer</var>, <code>"closed"</code>)).</li><li>IfAbruptNotifyError(<var>closed</var>, <var>observer</var>).</li><li>If <var>closed</var> is <code>true</code>, return <code>undefined</code>.</li><li>Let <var>len</var> be the number of elements in <var>items</var>.</li><li>Let <var>k</var> be 0.</li><li>Repeat, while <var>k</var> &lt; <var>len</var>,<ol><li>Let <var>kValue</var> be <var>items[k]</var>.</li><li>Let <var>nextResult</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-invoke">Invoke</a>(<var>observer</var>, <code>"next"</code>, «‍<var>kValue</var>»).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>nextResult</var>).</li><li>Let <var>closed</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-toboolean">ToBoolean</a>(<a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-get-o-p">Get</a>(<var>observer</var>, <code>"closed"</code>)).</li><li>IfAbruptNotifyError(<var>closed</var>, <var>observer</var>).</li><li>If <var>closed</var> is <code>true</code>, return <code>undefined</code>.</li><li>Increase k by 1.</li></ol></li><li>Let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-invoke">Invoke</a>(<var>observer</var>, <code>"complete"</code>, «‍»).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>result</var>).</li><li>Return <code>undefined</code>.
        </li></ol></emu-alg>
    </emu-clause>

</emu-clause>
</emu-import>
</emu-clause>

<emu-clause id="observable-prototype-properties">
    <h1><span class="secnum">3</span>Properties of the Observable Prototype Object<span class="utils"><span class="anchor"><a href="#observable-prototype-properties">#</a></span></span></h1>

    <p>The <code>Observable</code> prototype object is the intrinsic object %ObservablePrototype%. The value of the [[Prototype]] internal slot of the <code>Observable</code> prototype object is the intrinsic object %ObjectPrototype%. The <code>Observable</code> prototype object is an ordinary object.</p>

    <emu-import href="./prototype-properties.html"><emu-clause id="observable-prototype-subscribe">
    <h1><span class="secnum">3.1</span>Observable.prototype.subscribe ( observer )<span class="utils"><span class="anchor"><a href="#observable-prototype-subscribe">#</a></span></span></h1>

    <p>The <code>subscribe</code> function begins sending values to the supplied <var>observer</var> object by executing the Observable object's subscriber function.  It returns a <code>Subscription</code> object which may be used to cancel the subscription.</p>

    <p>The <code>subscribe</code> function performs the following steps:</p>

    <emu-alg><ol><li>Let <var>O</var> be the <code>this</code> value.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>O</var>) is not Object, throw a <code>TypeError</code> exception.</li><li>If <var>O</var> does not have an [[Subscriber]] internal slot, throw a <code>TypeError</code>
           exception.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>observer</var>) is not Object, throw a <code>TypeError</code> exception.</li><li>Let <var>subscription</var> be CreateSubscription(<var>observer</var>).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>subscription</var>).</li><li>Let <var>subscriptionObserver</var> be CreateSubscriptionObserver(<var>subscription</var>).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>subscriptionObserver</var>).</li><li>Let <var>start</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getmethod">GetMethod</a>(<var>observer</var>, <code>"start"</code>).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>start</var>).</li><li>If <var>start</var> is not <code>undefined</code>,<ol><li>Let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a>(<var>start</var>, <var>observer</var>, «‍<var>subscription</var>»).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>result</var>).</li><li>If SubscriptionClosed(<var>subscription</var>) is <code>true</code>, return <var>subscription</var>.</li></ol></li><li>Let <var>subscriber</var> be the value of <var>O's</var> [[Subscriber]] internal slot.</li><li>Assert: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iscallable">IsCallable</a>(<var>subscriber</var>) is <code>true</code>.</li><li>Let <var>subscriberResult</var> be ExecuteSubscriber(<var>subscriber</var>, <var>subscriptionObserver</var>).</li><li>If <var>subscriberResult</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">abrupt completion</a></emu-xref>,<ol><li>Let <var>errorResult</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-invoke">Invoke</a>(<var>subscriptionObserver</var>, <code>"error""</code>,
               «‍<var>subscriberResult</var>.[[value]]»).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>errorResult</var>).</li></ol></li><li>Else, set the [[Cleanup]] internal slot of <var>observer</var> to <var>subscriberResult</var>.[[value]].</li><li>If SubscriptionClosed(<var>subscription</var>) is <code>true</code>,<ol><li>Let <var>cleanupResult</var> be CleanupSubscription(<var>subscription</var>).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>cleanupResult</var>).</li></ol></li><li>Return <var>subscription</var>.
    </li></ol></emu-alg>

    <emu-clause id="observable-execute-subscriber">
        <h1><span class="secnum">3.1.1</span>Runtime Semantics: ExecuteSubscriber ( subscriber, observer )<span class="utils"><span class="anchor"><a href="#observable-execute-subscriber">#</a></span></span></h1>

        <p>The abstract operation ExecuteSubscriber with arguments <var>subscriber</var> and <var>observer</var> performs the following steps:</p>

        <emu-alg><ol><li>Assert: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iscallable">IsCallable</a>(<var>subscriber</var>) is <code>true</code>.</li><li>Assert: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>observer</var>) is Object.</li><li>Let <var>subscriberResult</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a>(<var>subscriber</var>, <code>undefined</code>, <var>observer</var>).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>subscriberResult</var>).</li><li>If <var>subscriberResult</var> is <code>null</code> or <code>undefined</code>, return <code>undefined</code>.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iscallable">IsCallable</a>(<var>subscriberResult</var>) is <code>true</code>, return <var>subscriberResult</var>.</li><li>Let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getmethod">GetMethod</a>(<var>subscriberResult</var>, <code>"unsubscribe"</code>).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>result</var>).</li><li>If <var>result</var> is <code>undefined</code>, throw a <code>TypeError</code> exception.</li><li>Let <var>cleanupFunction</var> be a new built-in function object as defined in Subscription Cleanup Functions.</li><li>Set the [[Subscription]] internal slot of <var>cancelFunction</var> to <var>subscriberResult</var>.</li><li>Return <var>cancelFunction</var>.
        </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="observable-subscription-cleanup-functions">
        <h1><span class="secnum">3.1.2</span>Subscription Cleanup Functions<span class="utils"><span class="anchor"><a href="#observable-subscription-cleanup-functions">#</a></span></span></h1>

        <p>A subscription cleanup function is an anonymous built-in function that has a [[Subscription]] internal slot.</p>

        <p>When a subscription cleanup function <var>F</var> is called the following steps are taken:</p>

        <emu-alg><ol><li>Assert: <var>F</var> as a [[Subscription]] internal slot whose value is an Object.</li><li>Let <var>subscription</var> be the value of the [[Subscription]] internal slot of <var>F</var>.</li><li>Return <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-invoke">Invoke</a>(<var>subscription</var>, <code>"unsubscribe"</code>, «‍»).
        </li></ol></emu-alg>

        <p>The <code>length</code> property of a subscription cleanup function is <code>0</code>.</p>
    </emu-clause>

    <emu-clause id="observable-prototype-foreach">
        <h1><span class="secnum">3.1.3</span>Observable.prototype.forEach ( callbackFn )<span class="utils"><span class="anchor"><a href="#observable-prototype-foreach">#</a></span></span></h1>

        <p>The <code>forEach</code> function subscribes to the observable and calls <var>callbackFn</var> for each element in the sequence.  It returns a Promise for the completion value of the sequence.</p>

        <p><var>callbackFn</var> is called with one argument: the value of the next element in the sequence.</p>

        <p>The <code>forEach</code> function performs the following steps:</p>

        <emu-alg><ol><li>Let <var>O</var> be the <code>this</code> value.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>O</var>) is not Object, throw a <code>TypeError</code> exception.</li><li>Let <var>promiseCapability</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-newpromisecapability">NewPromiseCapability</a>(%Promise%).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>promiseCapability</var>).</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iscallable">IsCallable</a>(<var>callbackFn</var>) is <code>false</code>,<ol><li>Let <var>r</var> be a new <code>TypeError</code> exception.</li><li>Let <var>rejectResult</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a>(<var>promiseCapability</var>.[[Reject]], <var>r</var>).</li><li>Return <var>promiseCapability</var>.[[Promise]].</li></ol></li><li>Let <var>observer</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-objectcreate">ObjectCreate</a>(%ObjectPrototype%).</li><li>Let <var>next</var> be a new built-in function object as defined in Observable.prototype.forEach Next Functions.</li><li>Set the [[CallbackFn]] internal slot of <var>next</var> to <var>callbackFn</var>.</li><li>Set the [[Reject]] internal slot of <var>next</var> to <var>promiseCapability</var>.[[Reject]].</li><li>Perform <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-createdataproperty">CreateDataProperty</a>(<var>observer</var>, <code>"next"</code>, <var>next</var>).</li><li>Perform <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-createdataproperty">CreateDataProperty</a>(<var>observer</var>, <code>"error"</code>, <var>promiseCapability</var>.[[Reject]]).</li><li>Perform <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-createdataproperty">CreateDataProperty</a>(<var>observer</var>, <code>"complete"</code>, <var>promiseCapability</var>.[[Resolve]]).</li><li>Let <var>subscribeResult</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-invoke">Invoke</a>(<var>O</var>, <code>"subscribe"</code>, «‍<var>observer</var>»).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ifabruptrejectpromise">IfAbruptRejectPromise</a>(<var>subscribeResult</var>, <var>promiseCapability</var>).</li><li>Return <var>promiseCapability</var>.[[Promise]].
        </li></ol></emu-alg>

        <emu-clause id="observable-prototype-foreach-next-functions">
            <h1><span class="secnum">3.1.3.1</span>Observable.prototype.forEach Next Functions<span class="utils"><span class="anchor"><a href="#observable-prototype-foreach-next-functions">#</a></span></span></h1>

            <p>An Observable.prototype.forEach next function is an anonymous built-in function that is used to process each element of an observable sequence when <var>forEach</var> is invoked. Each Observable.prototype.forEach next function has [[CallbackFn]] and [[Reject]] internal slots.</p>

            <p>When an Observable.prototype.forEach next function <var>F</var> is called with argument <var>x</var>, the following steps are taken:</p>

            <emu-alg><ol><li>Let <var>callbackFn</var> be the value of the [[CallbackFn]] internal slot of <var>F</var>.</li><li>Let <var>promiseReject</var> be the value of the [[Reject]] internal slot of <var>F</var>.</li><li>Let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a>(<var>callbackFn</var>, <code>undefined</code>, «‍<var>x</var>»).</li><li>If <var>result</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">abrupt completion</a></emu-xref>,<ol><li>Let <var>rejectResult</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a>(<var>promiseReject</var>, <code>undefined</code>, «<var>result</var>.[[value]]»).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>rejectResult</var>).</li><li>Return <code>undefined</code>.</li></ol></li><li>Return <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a>(<var>result</var>).
            </li></ol></emu-alg>
        </emu-clause>

    </emu-clause>

    <emu-clause id="observable-prototype-constructor">
        <h1><span class="secnum">3.1.4</span>Observable.prototype.constructor<span class="utils"><span class="anchor"><a href="#observable-prototype-constructor">#</a></span></span></h1>

        <p>The initial value of <code>Observable.prototype.constructor</code> is the intrinsic object %Observable%.</p>
    </emu-clause>

    <emu-clause id="observable-prototype-@@observable">
        <h1><span class="secnum">3.1.5</span>Observable.prototype [ @@observable ] ( )<span class="utils"><span class="anchor"><a href="#observable-prototype-@@observable">#</a></span></span></h1>

        <p>The following steps are taken:</p>

        <emu-alg><ol><li>Return the <code>this</code> value.
        </li></ol></emu-alg>

        <p>The value of the <code>name</code> property of this function is <code>"[Symbol.observable]"</code>.</p>
    </emu-clause>

</emu-clause>
</emu-import>
</emu-clause>

<emu-clause id="subscription-objects">
    <h1><span class="secnum">4</span>Subscription Objects<span class="utils"><span class="anchor"><a href="#subscription-objects">#</a></span></span></h1>

    <p>A Subscription is an object which represents a channel through which an Observable may send data to an Observer.</p>

    <emu-import href="./subscription.html"><emu-clause id="subscription-abstract-operations">
    <h1><span class="secnum">4.1</span>Subscription Abstract Operations<span class="utils"><span class="anchor"><a href="#subscription-abstract-operations">#</a></span></span></h1>

    <emu-clause id="create-subscription">
        <h1><span class="secnum">4.1.1</span>CreateSubscription ( observer ) Abstract Operation<span class="utils"><span class="anchor"><a href="#create-subscription">#</a></span></span></h1>

        <p>The abstract operation CreateSubscription with argument <var>observer</var> is used to create a Subscription object.  It performs the following steps:</p>

        <emu-alg><ol><li>Assert: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>observer</var>) is Object.</li><li>Let <var>subscription</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-objectcreate">ObjectCreate</a>(%SubscriptionPrototype%, «‍[[Observer]], [[Cleanup]]»).</li><li>Set <var>subscription's</var> [[Observer]] internal slot to <var>observer</var>.</li><li>Set <var>subscription's</var> [[Cleanup]] internal slot to <code>undefined</code>.</li><li>Return <var>subscription</var>.
        </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="create-subscription">
        <h1><span class="secnum">4.1.2</span>CreateSubscription ( observer ) Abstract Operation<span class="utils"><span class="anchor"><a href="#create-subscription">#</a></span></span></h1>

        <p>The abstract operation CreateSubscription with argument <var>observer</var> is used to create a Subscription object.  It performs the following steps:</p>

        <emu-alg><ol><li>Assert: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>observer</var>) is Object.</li><li>Let <var>subscription</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-objectcreate">ObjectCreate</a>(%SubscriptionPrototype%, «‍[[Observer]], [[Cleanup]]»).</li><li>Set <var>subscription's</var> [[Observer]] internal slot to <var>observer</var>.</li><li>Set <var>subscription's</var> [[Cleanup]] internal slot to <code>undefined</code>.</li><li>Return <var>subscription</var>.
        </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="cleanup-subscription">
        <h1><span class="secnum">4.1.3</span>CleanupSubscription ( subscription ) Abstract Operation<span class="utils"><span class="anchor"><a href="#cleanup-subscription">#</a></span></span></h1>

        <p>The abstract operation CleanupSubscription with argument <var>subscription</var> performs the following steps:</p>

        <emu-alg><ol><li>Assert: <var>subscription</var> is a Subscription object.</li><li>Let <var>cleanup</var> be the value of the [[Cleanup]] internal slot of <var>subscription</var>.</li><li>If <var>cleanup</var> is <code>undefined</code>, return <code>undefined</code>.</li><li>Assert: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-iscallable">IsCallable</a>(<var>cleanup</var>) is <code>true</code>.</li><li>Set the value of the [[Cleanup]] internal slot of <var>subscription</var> to <code>undefined</code>.</li><li>Let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a>(<var>cleanup</var>, <code>undefined</code>, «‍»).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>result</var>).</li><li>Return <code>undefined</code>.
        </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="subscription-closed">
        <h1><span class="secnum">4.1.4</span>SubscriptionClosed ( subscription ) Abstract Operation<span class="utils"><span class="anchor"><a href="#subscription-closed">#</a></span></span></h1>

        <p>The abstract operation SubscriptionClosed with argument <var>subscription</var> performs the following steps:</p>

        <emu-alg><ol><li>Assert: <var>subscription</var> is a Subscription object.</li><li>If the value of the [[Observer]] internal slot of <var>subscription</var> is <code>undefined return </code>true`.</li><li>Else, return <code>false</code>.
        </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="subscription-prototype-object">
        <h1><span class="secnum">4.1.5</span>The %SubscriptionPrototype% Object<span class="utils"><span class="anchor"><a href="#subscription-prototype-object">#</a></span></span></h1>

        <p>All Subscription objects inherit properties from the %SubscriptionPrototype% intrinsic object.  The %SubscriptionPrototype% object is an ordinary object and its [[Prototype]] internal slot is the %ObjectPrototype% intrinsic object. In addition, %SubscriptionPrototype% has the following properties:</p>

        <emu-clause id="subscription-prototype-unsubscribe">
            <h1><span class="secnum">4.1.5.1</span>%SubscriptionPrototype%.unsubscribe ( )<span class="utils"><span class="anchor"><a href="#subscription-prototype-unsubscribe">#</a></span></span></h1>
            <emu-alg><ol><li>Let <var>subscription</var> be the <code>this</code> value.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>subscription</var>) is not Object, throw a <code>TypeError</code> exception.</li><li>If <var>subscription</var> does not have all of the internal slots of a Subscription instance,
                   throw a <code>TypeError</code> exception.</li><li>If SubscriptionClosed(<var>subscription</var>) is <code>true</code>, return <code>undefined</code>.</li><li>Set the value of the [[Observer]] internal slot of <var>subscription</var> to <code>undefined</code>.</li><li>Return CleanupSubscription(<var>subscription</var>).
            </li></ol></emu-alg>
        </emu-clause>
    </emu-clause>

</emu-clause>
</emu-import>
</emu-clause>

<emu-clause id="subscription-observer-objects">
    <h1><span class="secnum">5</span>Subscription Observer Objects<span class="utils"><span class="anchor"><a href="#subscription-observer-objects">#</a></span></span></h1>

    <p>A Subscription Observer is an object which wraps the <var>observer</var> argument supplied to the  <var>subscribe</var> method of Observable objects.  Subscription Observer objects are passed as the single parameter to an observable's <var>subscriber</var> function.  They enforce the following guarantees:</p>

    <ul>
        <li>If the observer's <code>error</code> method is called, the observer will not be invoked again and the observable's cleanup function will be called.</li>
        <li>If the observer's <code>complete</code> method is called, the observer will not be invoked again and the observable's cleanup function will be called.</li>
        <li>If the observer throws an exception, the observable's cleanup function will be called.</li>
        <li>When the subscription is canceled, the observer will not be invoked again.</li>
    </ul>

    <p>In addition, Subscription Observer objects provide default behaviors when the observer does not implement <code>next</code>, <code>error</code> or <code>complete</code>.</p>

    <emu-import href="./subscription-observer.html"><emu-clause id="subscription-observer-abstract-operations">
    <h1><span class="secnum">5.1</span>Subscription Observer Abstract Operations<span class="utils"><span class="anchor"><a href="#subscription-observer-abstract-operations">#</a></span></span></h1>

    <emu-clause id="create-subscription-observer">
        <h1><span class="secnum">5.1.1</span>CreateSubscriptionObserver ( subscription ) Abstract Operation<span class="utils"><span class="anchor"><a href="#create-subscription-observer">#</a></span></span></h1>

        <p>The abstract operation CreateSubscriptionObserver with argument <var>observer</var> is used to create a normalized observer which can be supplied to an observable's <var>subscriber</var> function.  It performs the following steps:</p>

        <emu-alg><ol><li>Assert: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>observer</var>) is Object.</li><li>Let <var>subscriptionObserver</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-objectcreate">ObjectCreate</a>(%SubscriptionObserverPrototype%,
               «‍[[Subscription]]»).</li><li>Set <var>subscriptionObserver's</var> [[Subscription]] internal slot to <var>subscription</var>.</li><li>Return <var>subscriptionObserver</var>.
        </li></ol></emu-alg>
    </emu-clause>
</emu-clause>

<emu-clause id="subscription-observer-prototype-object">
    <h1><span class="secnum">5.2</span>The %SubscriptionObserverPrototype% Object<span class="utils"><span class="anchor"><a href="#subscription-observer-prototype-object">#</a></span></span></h1>

    <p>All Subscription Observer objects inherit properties from the %SubscriptionObserverPrototype% intrinsic object.  The %SubscriptionObserverPrototype% object is an ordinary object and its [[Prototype]] internal slot is the %ObjectPrototype% intrinsic object. In addition, %SubscriptionObserverPrototype% has the following properties:</p>

    <emu-clause id="subscription-prototype-closed">
        <h1><span class="secnum">5.2.1</span>get %SubscriptionObserverPrototype%.closed<span class="utils"><span class="anchor"><a href="#subscription-prototype-closed">#</a></span></span></h1>

        <p>%SubscriptionObserverPrototype%.closed is an accessor property whose set accessor function is undefined. Its get accessor function performs the following steps:</p>

        <emu-alg><ol><li>Let <var>O</var> be the <code>this</code> value.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>O</var>) is not Object, throw a <code>TypeError</code> exception.</li><li>If <var>O</var> does not have all of the internal slots of a Subscription Observer instance,
               throw a <code>TypeError</code> exception.</li><li>Let <var>subscription</var> be the value of the [[Subscription]] internal slot of <var>O</var>.</li><li>Return SubscriptionClosed(<var>subscription</var>).
        </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="subscription-observer-prototype-next">
        <h1><span class="secnum">5.2.2</span>%SubscriptionObserverPrototype%.next ( value )<span class="utils"><span class="anchor"><a href="#subscription-observer-prototype-next">#</a></span></span></h1>
        <emu-alg><ol><li>Let <var>O</var> be the <code>this</code> value.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>O</var>) is not Object, throw a <code>TypeError</code> exception.</li><li>If <var>O</var> does not have all of the internal slots of a Subscription Observer instance,
               throw a <code>TypeError</code> exception.</li><li>Let <var>subscription</var> be the value of the [[Subscription]] internal slot of <var>O</var>.</li><li>If SubscriptionClosed(<var>subscription</var>) is <code>true</code>, return <code>undefined</code>.</li><li>Let <var>observer</var> be the value of the [[Observer]] internal slot of <var>subscription</var>.</li><li>Assert: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>observer</var>) is Object.</li><li>Let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getmethod">GetMethod</a>(<var>observer</var>, <code>"next"</code>).</li><li>If <var>result</var>.[[type]] is <code>normal</code>,<ol><li>Let <var>nextMethod</var> be <var>result</var>.[[value]].</li><li>If <var>nextMethod</var> is <code>undefined</code>, let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-normalcompletion">NormalCompletion</a>(<code>undefined</code>).</li><li>Else, let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a>(<var>nextMethod</var>, <var>observer</var>, «‍<var>value</var>»).</li></ol></li><li>If <var>result</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">abrupt completion</a></emu-xref>,<ol><li>Let <var>closeResult</var> be CloseSubscription(<var>subscription</var>).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>closeResult</var>).</li></ol></li><li>Return <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a>(<var>result</var>).
        </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="subscription-observer-prototype-error">
        <h1><span class="secnum">5.2.3</span>%SubscriptionObserverPrototype%.error ( exception )<span class="utils"><span class="anchor"><a href="#subscription-observer-prototype-error">#</a></span></span></h1>
        <emu-alg><ol><li>Let <var>O</var> be the <code>this</code> value.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>O</var>) is not Object, throw a <code>TypeError</code> exception.</li><li>If <var>O</var> does not have all of the internal slots of a Subscription Observer instance,
               throw a <code>TypeError</code> exception.</li><li>Let <var>subscription</var> be the value of the [[Subscription]] internal slot of <var>O</var>.</li><li>If SubscriptionClosed(<var>subscription</var>) is <code>true</code>, return Completion{[[type]]: <code>throw</code>,
               [[value]]: <var>exception</var>, [[target]]: <code>empty</code>}.</li><li>Let <var>observer</var> be the value of the [[Observer]] internal slot of <var>subscription</var>.</li><li>Assert: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>observer</var>) is Object.</li><li>Set the value of the [[Observer]] internal slot of <var>subscription</var> to <code>undefined</code>.</li><li>Let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getmethod">GetMethod</a>(<var>observer</var>, <code>"error"</code>).</li><li>If <var>result</var>.[[type]] is <code>normal</code>,<ol><li>Let <var>errorMethod</var> be <var>result</var>.[[value]].</li><li>If <var>errorMethod</var> is <code>undefined</code>, let <var>result</var> be Completion{[[type]]: <code>throw</code>,
                   [[value]]: <var>exception</var>, [[target]]: <code>empty</code>}.</li><li>Else, let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a>(<var>errorMethod</var>, <var>observer</var>, «‍<var>value</var>»).</li></ol></li><li>Let <var>cleanupResult</var> be CleanupSubscription(<var>O</var>).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>cleanupResult</var>).</li><li>Return <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a>(<var>result</var>).
        </li></ol></emu-alg>
    </emu-clause>

    <emu-clause id="subscription-observer-prototype-complete">
        <h1><span class="secnum">5.2.4</span>%SubscriptionObserverPrototype%.complete ( value )<span class="utils"><span class="anchor"><a href="#subscription-observer-prototype-complete">#</a></span></span></h1>
        <emu-alg><ol><li>Let <var>O</var> be the <code>this</code> value.</li><li>If <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>O</var>) is not Object, throw a <code>TypeError</code> exception.</li><li>If <var>O</var> does not have all of the internal slots of a Subscription Observer instance,
               throw a <code>TypeError</code> exception.</li><li>Let <var>subscription</var> be the value of the [[Subscription]] internal slot of <var>O</var>.</li><li>If SubscriptionClosed(<var>subscription</var>) is <code>true</code>, return <code>undefined</code>.</li><li>Let <var>observer</var> be the value of the [[Observer]] internal slot of <var>subscription</var>.</li><li>Assert: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-ecmascript-data-types-and-values">Type</a>(<var>observer</var>) is Object.</li><li>Set the value of the [[Observer]] internal slot of <var>subscription</var> to <code>undefined</code>.</li><li>Let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-getmethod">GetMethod</a>(<var>observer</var>, <code>"complete"</code>).</li><li>If <var>result</var>.[[type]] is <code>normal</code>,<ol><li>Let <var>completeMethod</var> be <var>result</var>.[[value]].</li><li>If <var>completeMethod</var> is <code>undefined</code>, let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-normalcompletion">NormalCompletion</a>(<code>undefined</code>).</li><li>Else, let <var>result</var> be <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-call">Call</a>(<var>completeMethod</var>, <var>observer</var>, «<var>‍value</var>»).</li></ol></li><li>Let <var>cleanupResult</var> be CleanupSubscription(<var>O</var>).</li><li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-returnifabrupt">ReturnIfAbrupt</a>(<var>cleanupResult</var>).</li><li>Return <a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-completion-record-specification-type">Completion</a>(<var>result</var>).
        </li></ol></emu-alg>
    </emu-clause>

</emu-clause>
</emu-import>
</emu-clause>
</body>